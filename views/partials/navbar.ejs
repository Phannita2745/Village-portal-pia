<nav class="fixed top-0 left-0 w-full z-50 flex justify-between items-center px-10 py-3 shadow bg-white">
  <!-- โลโก้ -->
  <div class="flex items-center justify-between px-10 h-16">
    <img src="/logo.png" alt="logo" class="w-9 h-9" />
    <div>
      <h1 class="text-lg font-bold text-gray-900">VillagePortal</h1>
      <p class="text-xs text-gray-500 uppercase tracking-wide">A village news notification website</p>
    </div>
  </div>

  <!-- เมนู -->
  <ul class="flex space-x-6 text-green-700 font-semibold text-base">
    <li><a href="/" class="hover:underline">หน้าแรก</a></li>
    <li><a href="/news" class="hover:underline">ข่าวประชาสัมพันธ์</a></li>
    <li><a href="/activities" class="hover:underline">ภาพกิจกรรม</a></li>
    <li><a href="/complaints" class="hover:underline">หัวข้อร้องเรียน</a></li>
    <li><a href="/contact" class="hover:underline">ติดต่อเรา</a></li>
    <!-- บัญชีผู้ใช้ / เข้าสู่ระบบ -->
    <div class="relative">
      <% const isLoggedIn = typeof user !== 'undefined' && user; %>

      <% if (isLoggedIn) { %>
        <!-- ปุ่มผู้ใช้แบบภาพตัวอย่าง -->
        <button id="userMenuBtn" class="user-chip" type="button">
          <img class="user-chip__avatar"
              src="<%= user.photoUrl || '/images/default-avatar.jpg' %>"
              alt="avatar">
          <span class="user-chip__name"><%= user.displayName || user.name || 'ผู้ใช้' %></span>
          <svg class="user-chip__chevron" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path fill="#0F1E98" d="M6.7 9.3a1 1 0 0 1 1.4 0L12 13.2l3.9-3.9a1 1 0 1 1 1.4 1.4l-4.6 4.6a1 1 0 0 1-1.4 0L6.7 10.7a1 1 0 0 1 0-1.4z"/>
          </svg>
        </button>

        <!-- เมนูดรอปดาวน์ -->
        <div id="userMenu" class="menu-popover hidden">
          <a href="/profile/edit" class="menu-item">แก้ไขโปรไฟล์</a>
          <a href="/logout" class="menu-item">ออกจากระบบ</a>
        </div>
      <% } else { %>
        <!-- ยังไม่ล็อกอิน: แสดงไอคอนสีเขียวตามภาพตัวอย่าง (คลิกเพื่อเข้าสู่ระบบ) -->
        <a href="/login" class="login-icon" aria-label="เข้าสู่ระบบ">
          <svg viewBox="0 0 64 64" width="36" height="36">
            <circle cx="32" cy="32" r="28" fill="#fff" stroke="#00A651" stroke-width="4"/>
            <circle cx="32" cy="24" r="8" fill="#00A651"/>
            <path d="M16 46c3.5-7 11-10 16-10s12.5 3 16 10" fill="#00A651"/>
          </svg>
        </a>
      <% } %>
    </div>
  </ul>
  
</nav>

<script>
  const btn = document.getElementById('userMenuBtn');
  const menu = document.getElementById('userMenu');
  if (btn && menu) {
    btn.addEventListener('click', () => {
      menu.classList.toggle('hidden');
      btn.querySelector('.user-chip__chevron')?.classList.toggle('is-open');
    });
    document.addEventListener('click', (e) => {
      if (!btn.contains(e.target) && !menu.contains(e.target)) {
        menu.classList.add('hidden');
        btn.querySelector('.user-chip__chevron')?.classList.remove('is-open');
      }
    });
  }
</script>